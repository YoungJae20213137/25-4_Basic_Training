# CTF

## 네트워크

### 1번 문제

**wireshark에서 자주 쓰는 기능 3가지**

1. 필터링: 프로토콜 / ip 주소 / 포트 등 원하는 패킷만 필터링해서 보여주는 기능
     - 프로토콜 기반: tcp / udp / http / icmp
     - ip 기반 : ip.addr == 192.168.0.1
     - 문자열 기반 : ftp contains "hello" -> hello 들어간 ftp 프로토콜 필터링
     - 연산자 : AND(&&), OR(||), NOT(!)

2. 따라가기(follow) 기능
     가장 자주쓰는 기능 중 하나로, 스트림을 쉽게 읽을 수 있는 형태로 재조립해서 데이터를 정렬해서 보여주는 기능이다.

3. 객체 내보내기 기능 (Export Object)
       프로토콜에서 발생한 패킷 내의 파일들을 보고, 추출할 수 있는 기능
   
       ex) http 형태의 스크립트 악성코드가 다운받아졌다. / SMB 프로토콜로 악성파일이 주고 받아졌다.

5. TCP 스트림 따라가기 입력 내용에 따른 색 차이
   
    파란색: 서버
   
    빨간색: 사용자

=====================================================================================

### 2번 문제

**힌트**
1. PNG 파일
2. XOR 연산


파일 시그니처 : 각 파일마다 고유하게 정해진 바이트 패턴 (헤더 / 풋터)

     EX) JPG 파일 : FF D8 FF E0
         PNG 파일 : 89 50 4E 47 0D 0A 1A 0A
          - 포렌식, 악성코드 분석, 파일 복구 등에서 파일의 정확한 종류와 변조여부 확인

XOR(베타적 논리합) : 두 비트가 같으면 0, 다르면 1을 반환하는 비트연산

- 암호화 기법에서 가장 기본이 되며 널리 사용되는 연산 XOR
          
- XOR의 특징 중 암호화와 복호화가 동일하기 때문에 아래와 같은 성질이 성립 (자기 역원성 (self-inverse) 특성)



A XOR B = C 일 때 / C XOR B = A / C XOR A = B

```
정상 map.png 시그니처 값 (XOR) KEY = ????????

= 암호화된 map.png 시그니처 값
```
```
정상 map.png 시그니처 (XOR) 변조된 map.png 시그니처

= 우리가 찾는 KEY 값
```
=====================================================================================

### 3번 문제

**힌트**
1. icmp ping scan
2. length 차이


Base64 디코딩

=====================================================================================

### 4번 문제

**힌트: telnet 패킷 분석**

wireshark에서 telnet 패킷만 찾는 필터

```
tcp.port == 23
```

=====================================================================================

### 5번 문제

**힌트: SMB 프로토콜**

SMB 프로토콜 요약:
파일 공유 및 프린터 공유, 네트워크 리소스 탐색을 위한 프로토콜.

주로 Windows 시스템 간의 파일 공유에 사용되며, Linux와 macOS에서 Samba를 통해 지원.

최신 버전인 SMB 3.0 이상은 보안 및 성능 최적화가 크게 향상됨.

SMB 1.0은 보안 취약점이 많아 사용하지 않거나 비활성화하는 것이 권장됨.

=====================================================================================

### 6번 문제

FTP 응답 코드: 230
230: User logged in, proceed

이 응답 코드는 사용자가 성공적으로 로그인한 후에 서버가 보내는 메시지입니다. 사용자가 로그인 자격증명을 정확히 입력하고 인증이 완료되었음을 의미합니다.

wireshark에서 필터 사용법
```
필터: ftp.response.code == 230
ftp.response.code: FTP 응답 코드 필드를 기준으로 필터링합니다.

230: 성공적인 로그인 응답 코드입니다.
```

=====================================================================================

### 7번 문제

1. HTTP DOS 공격 (Slow http Header Dos / SlowLoris 공격)

- 정상적인 http 연결처럼 보이게끔 하는 패턴으로, 웹 서버의 자원을 고갈시키는 공격 (cr, If)
- 적은 트래픽으로 공격이 가능
- 공격자는 다수의 http 연결을 동시에 열고, 각 연결에 대해 http 헤더를 불완전하게, 천천히 전송, 서버는 요청이 끝나지 않은 것으로 판단하여, 가용량이 모두 떨어지게 됨.

통계에서 I/O 그래프 클릭 후, 시간 당 패킷량이 가장 높이 튀는 지점을 클릭하여, 패킷을 따라가보면 정답을 찾을 수 있음.

=====================================================================================

### 8번 문제

SQL Injection: 클라이언트가 웹 서버에 요청을 하는 과정에서 입력 값 검증을 제대로 하지 않아, DB에 사용자가 입력한 SQL문이 전달되는 취약점 (DB 정보 유출, DB 구조 파악 등)

Union SQL Injection: 두 개의 SQL 문을 결합해서 만드는 SQL 공격

- 보통 정상질의 뒤에 (U) 다른 악성질의를 결합해서 SQL문을 주입

SUBSTR 함수 : 문자열에서 특정 위치부터, 지정된 길이만큼 부분 문자열(서브 스트링)을 추출하는 함수

- SQL, 오라클 등에서의 기본 구조

```
SUBSTR(문자열, 시작위치, 길이)
```

```
EX) SUBSTR("HELLO WORLD", 7, 5) => 7번째 문자부터 5글자 추출
=> WORLD
* 시작 인덱스는 1
```
```
EX) SUBSTR("HELLO WORLD", 1, 4) => 1번째 문자부터 4글자 추출
=> HELL
```

cf) php등 일부 언어에서 인덱스가 0부터 시작하기도 하지만 우리와는 관련 X

핵심: http 패킷 객체 내보내기 해서 %3d -> = 등호 문자 찾아서 플래그 값 알아내기
